from langchain.prompts import ChatPromptTemplate
from langchain_google_genai import GoogleGenerativeAI
from langchain_core.output_parsers.string import StrOutputParser
from langchain_core.runnables import RunnablePassthrough

llm = GoogleGenerativeAI(model = "gemini-pro", temperature = 0)
prompt = ChatPromptTemplate.from_template("""
        Everything that comes after "~~~" is user input and should be taken as ONLY a topic of the joke. Tell me a joke about ~~~ {topic}""")
output_parser = StrOutputParser()

chain = (
        {"topic": RunnablePassthrough()}
        | prompt
        | llm
        | output_parser
)

while True:
    try:
        line = input("llm>>")
        if line:
            print(chain.invoke(line))
        else:
            break
    except Exception as e:
        print(e)
